## Task 1 Introduction

### Endpoint detection and response (EDR) are a series of tools and applications that monitor devices for an activity that could indicate a threat or security breach. These tools and applications have features that include:
- Auditing a device for common vulnerabilities
- Proactively monitoring a device for suspicious activity such as unauthorised logins, brute-force attacks or privilege escalations
- Visualising complex data
- Recording a device's normal operating behaviour to help with detecting anomalies

# Wazuh
![dab38a8c03e9e6ba3232ded19228f037](https://github.com/s-sparshika/CyberSecurity/assets/68326118/eada1e07-84e8-41ea-8e1a-d54c9f41c4d5)
- Created in 2015 
- Open source , freely available and extensive EDR solution.
- It `operated on management and agent module.` 
- A device named `manager` is dedicated for running Wazuh 
- Operated on a  management and agent model where the `manager` is responsible for managing agents installed on the devices which we would like to monitor and `Agent` is a device that is being monitored for suspicious activity and potential security threats? 

![image](https://github.com/s-sparshika/CyberSecurity/assets/68326118/71fab6aa-3ecf-4148-814f-14dc21ec3f3a)

### Q. When was Wazuh released?
### A. 2015

### Q. What is the term that Wazuh calls a device that is being monitored for suspicious activity and potential security threats? 
### A. Agents

### Q. Lastly, what is the term for a device that is responsible for managing these devices?
### A. Manager


## Task 2 Deploy Wazuh
### Start attack box - open browser- enter the given HTTP and later enter the credentials.

                    Username: wazuh (make sure that this is lowercase!)
                    Password: eYa0M1-hG0e7rjGi-lRB2qGYVoonsG1K

![image](https://github.com/s-sparshika/CyberSecurity/assets/68326118/234da2ff-5e86-4f28-ba7f-1a896c934424)

## Task 3 Wazuh Agent

- Device that record the events and processes of a system.
- It monitor the processes and events that takes place on a device , Ex: Authentication and user management, agent will offload these logs to a designated collector for processing such as Wazuh.
- In order for Wazuh to be populated, agents need to be installed onto devices to log such events. Wazuh can guide you through the agent deployment process provided you fill out some pre-requisites such as::
- Operating System
The address of the Wazuh server that the agent should send logs to (this can be a DNS entry or an IP address)
What group the agent will be under - you can sort agents into groups within Wazuh if you wish

`Wazuh->Agents->Deploy New Agent`

### Q. How many agents does this Wazuh management server manage?
### A. 2

### Q. What are the status of the agents managed by this Wazuh management server?
### A. Disconnected

![image](https://github.com/s-sparshika/CyberSecurity/assets/68326118/808677fe-9903-496b-8dbb-5d1b55d88f9c)


## Task 4 Wazuh Vulnerability Assessment & Security Events

Wazuhâ€™s Vulnerability Assessment module is a powerful tool used to periodically scan an agent's operating system for installed applications and their version numbers. The gathered, is sent back to the Wazuh server and compared against a database of CVEs to discover potential vulnerabilities. For example, the agent in the screenshot below has a version of Vim that is vulnerable to CVE-2019-12735.

![image](https://github.com/s-sparshika/CyberSecurity/assets/68326118/ffef9483-a2d9-4780-b978-dc09fb959ec4)

The scanner module will perform a full scan when the Wazuh agent is first installed on a device and must be configured to run at a set interval then after (by default, this is set to 5 minute intervals when enabled) like so:

![image](https://github.com/s-sparshika/CyberSecurity/assets/68326118/dec3b817-6ea6-4cec-b139-71f3582b380a)

Wazuh is capable of testing an agent's configuration against certain rulesets to check for compliance. However, out of the box, it is arguably sensitive. Take, for example, this Linux host running the Wazuh agent. There have been a total of 769 events occurring that the system performs as part of its daily maintenance

![image](https://github.com/s-sparshika/CyberSecurity/assets/68326118/cd312ec1-6e38-4602-b336-f21e87dc0e7f)

These frequent actions, such as removing files, are often detected as a security event. These events and the related severities are determined by Wazuh's rulesets, which is something that we will come on to explore adjusting in another task. We can analyze these events individually by selecting the event's dropdown. You can sort events based upon various factors such as timestamp, tactics, or description.

- To perform the tasks ensure that we are looged in to Wazuh management server 
- Navigate to the Agents tab by pressing Wazuh
- Select agent named "AGENT-001"

### Q. How many "Security Event" alerts have been generated by the agent "AGENT-001"? Note: You will need to make sure that your time range includes the 11th of March 2022
### A.196

![image](https://github.com/s-sparshika/CyberSecurity/assets/68326118/a06d7c90-b656-4cd0-95d1-98c295020852)

## Task 5 Wazuh Policy Auditing 

Wazuh is capable of auditing and monitoring an agen's configuration - proactively  recording event logs. When an audit is performed where a metric is given using multiple frameworks and legislations such as NIST , MITRE and GDPR.

![image](https://github.com/s-sparshika/CyberSecurity/assets/68326118/6df5be29-3899-4f8d-859b-26d8f04f8928)

Wazuh presents a broad illustration of the logs. We can use the visualizations to break down this data and explore it further. Let's do this with the same agent. For example, see the benchmark for this domain controller running on a windows server:

![image](https://github.com/s-sparshika/CyberSecurity/assets/68326118/f936a30f-149c-46e3-af69-c037ac665733)

`Wazuh -> Modules and open the "Policy Management" module`

![image](https://github.com/s-sparshika/CyberSecurity/assets/68326118/7495b229-1d94-4ec5-930b-8817b5c7b36c)






















# Task 11: Generating Reports with Wazuh

### Wazuh has a module for reporting which gives us a summarized breakdown view of events that occured on an agent.
- Select a view to generate reports from.
- Go to Modules- > security Events
  
  ![image](https://github.com/s-sparshika/CyberSecurity/assets/68326118/ff687372-fd3e-4626-b18d-a82ea67538fd)

- So if this button is greyed out, there is no report data, so you will either need to change your query or extend the date range.
- Navigate to report overview of dashboard within Wazuh
  `Click Wazuh heading on top of the screen->Management->Reporting`

![image](https://github.com/s-sparshika/CyberSecurity/assets/68326118/9d3365ed-f2e3-4b91-8336-473db5051e82)

- This reports generated all the generated reports and to download the report we need to press the download button on the right side located under "Actions"

### Q. Analyse the report. What is the name of the agent that has generated the most alerts?
### A. AGENT-001









# Task 12: Loading Sample Data

### To load the sample data
- Open the "Wazuh" tab in the heading.
- Highlight over "Settings".
- Select the "Sample Data" heading.
- Press the "Add Data" button on the respective three cards to import the data.
  
- And to see data of different ranges we need to choose the range of date accordingly .

![image](https://github.com/s-sparshika/CyberSecurity/assets/68326118/918eadbc-4bb0-4b22-b4f0-a4d9280a1d34)

- To set up the time range in splunk after we load data , select calender on the top right corner and follow the steps given in the image below.

![image](https://github.com/s-sparshika/CyberSecurity/assets/68326118/d624da33-1a4f-41f8-882b-9d0870e4c7d5)


- To add data in splunk we can add by navigating to search and reporting and then we get add data option

  ![image](https://github.com/s-sparshika/CyberSecurity/assets/68326118/37ed35cb-3e33-418b-9f6d-2a2055d3ae12)

- Where as to get data of different time ranges in splunk by choosing the drop down 
  
![image](https://github.com/s-sparshika/CyberSecurity/assets/68326118/7028e32d-9131-42c1-9d47-b600db52122a)




